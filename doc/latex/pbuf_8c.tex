\hypertarget{pbuf_8c}{}\doxysection{/root/\+Documents/\+A\+S\+L\+S/\+Firmware\+\_\+\+V2.4/cueos/net/src/core/pbuf.c File Reference}
\label{pbuf_8c}\index{/root/Documents/ASLS/Firmware\_V2.4/cueos/net/src/core/pbuf.c@{/root/Documents/ASLS/Firmware\_V2.4/cueos/net/src/core/pbuf.c}}
{\ttfamily \#include \char`\"{}lwip/opt.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/stats.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/def.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/mem.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/memp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/pbuf.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lwip/sys.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
Include dependency graph for pbuf.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pbuf_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{pbuf_8c_a8357a994e45ff94c9494aa55b6c3ecb3}\label{pbuf_8c_a8357a994e45ff94c9494aa55b6c3ecb3}} 
\#define {\bfseries S\+I\+Z\+E\+O\+F\+\_\+\+S\+T\+R\+U\+C\+T\+\_\+\+P\+B\+UF}~\mbox{\hyperlink{group__compiler__abstraction_gaef204be511fd32f681b55abc08e9ae18}{L\+W\+I\+P\+\_\+\+M\+E\+M\+\_\+\+A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}}(sizeof(struct \mbox{\hyperlink{structpbuf}{pbuf}}))
\item 
\mbox{\Hypertarget{pbuf_8c_a3dad81a8286ee8e9a7c70a74f9f4bb0f}\label{pbuf_8c_a3dad81a8286ee8e9a7c70a74f9f4bb0f}} 
\#define {\bfseries P\+B\+U\+F\+\_\+\+P\+O\+O\+L\+\_\+\+B\+U\+F\+S\+I\+Z\+E\+\_\+\+A\+L\+I\+G\+N\+ED}~\mbox{\hyperlink{group__compiler__abstraction_gaef204be511fd32f681b55abc08e9ae18}{L\+W\+I\+P\+\_\+\+M\+E\+M\+\_\+\+A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}}(\mbox{\hyperlink{group__lwip__opts__pbuf_gae61f4491d56e805e79b79eb5d35a00e5}{P\+B\+U\+F\+\_\+\+P\+O\+O\+L\+\_\+\+B\+U\+F\+S\+I\+ZE}})
\item 
\mbox{\Hypertarget{pbuf_8c_aed70c61e971683736c569a1a99b76569}\label{pbuf_8c_aed70c61e971683736c569a1a99b76569}} 
\#define {\bfseries P\+B\+U\+F\+\_\+\+P\+O\+O\+L\+\_\+\+I\+S\+\_\+\+E\+M\+P\+TY}()
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$ \mbox{\hyperlink{group__pbuf_gacfcb0a2af918658ba0afe36499c65f47}{pbuf\+\_\+alloc}} (\mbox{\hyperlink{group__pbuf_gaee1baa59bb2f85ba575b5a8619ac1ebf}{pbuf\+\_\+layer}} layer, u16\+\_\+t length, \mbox{\hyperlink{group__pbuf_gab7e0e32fcc292c0d7107721766ed92fb}{pbuf\+\_\+type}} type)
\item 
void \mbox{\hyperlink{group__pbuf_ga50abfe830a33a1a47a562febee66015d}{pbuf\+\_\+realloc}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, u16\+\_\+t new\+\_\+len)
\item 
u8\+\_\+t \mbox{\hyperlink{pbuf_8c_a0f81deff4a0e6e8e0ff161a7b9871449}{pbuf\+\_\+header}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, s16\+\_\+t header\+\_\+size\+\_\+increment)
\item 
u8\+\_\+t \mbox{\hyperlink{pbuf_8c_ad0e64d6fbc423593461063da97da9ce6}{pbuf\+\_\+header\+\_\+force}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, s16\+\_\+t header\+\_\+size\+\_\+increment)
\item 
u8\+\_\+t \mbox{\hyperlink{group__pbuf_gab0dd696fb4b6bc65e548944584f1738b}{pbuf\+\_\+free}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p)
\item 
u16\+\_\+t \mbox{\hyperlink{pbuf_8c_a5df7ac5ae59012fe9aeddba375a72190}{pbuf\+\_\+clen}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p)
\item 
void \mbox{\hyperlink{group__pbuf_ga77f6bbd69e45e542014d9c547c7da74e}{pbuf\+\_\+ref}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p)
\item 
void \mbox{\hyperlink{group__pbuf_ga82429084fe29015509c9b4a072707cd4}{pbuf\+\_\+cat}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$h, struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$t)
\item 
void \mbox{\hyperlink{group__pbuf_ga831c9a72bda1d3bd4c7b96f5a0e3b891}{pbuf\+\_\+chain}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$h, struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$t)
\item 
struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$ \mbox{\hyperlink{pbuf_8c_abf3d29c4f43986b4cb5eb314d5b9729d}{pbuf\+\_\+dechain}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p)
\item 
\mbox{\hyperlink{group__infrastructure__errors_gaf02d9da80fd66b4f986d2c53d7231ddb}{err\+\_\+t}} \mbox{\hyperlink{group__pbuf_gaba88511dee3df4b631fde691f421320d}{pbuf\+\_\+copy}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p\+\_\+to, const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p\+\_\+from)
\item 
u16\+\_\+t \mbox{\hyperlink{group__pbuf_gac2f1f58fd36042e82af46f5015720899}{pbuf\+\_\+copy\+\_\+partial}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$buf, void $\ast$dataptr, u16\+\_\+t len, u16\+\_\+t offset)
\item 
struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$ \mbox{\hyperlink{group__pbuf_ga6a961522d81f0327aaf4d4ee6d96c583}{pbuf\+\_\+skip}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$in, u16\+\_\+t in\+\_\+offset, u16\+\_\+t $\ast$out\+\_\+offset)
\item 
\mbox{\hyperlink{group__infrastructure__errors_gaf02d9da80fd66b4f986d2c53d7231ddb}{err\+\_\+t}} \mbox{\hyperlink{group__pbuf_gad1e31e370271335b197272af2724ca85}{pbuf\+\_\+take}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$buf, const void $\ast$dataptr, u16\+\_\+t len)
\item 
\mbox{\hyperlink{group__infrastructure__errors_gaf02d9da80fd66b4f986d2c53d7231ddb}{err\+\_\+t}} \mbox{\hyperlink{group__pbuf_gae1cf2bf7454ff87ff377b0b2262f9b44}{pbuf\+\_\+take\+\_\+at}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$buf, const void $\ast$dataptr, u16\+\_\+t len, u16\+\_\+t offset)
\item 
struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$ \mbox{\hyperlink{group__pbuf_ga54ac7b116c6f53c704cbf74f35a8b35c}{pbuf\+\_\+coalesce}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, \mbox{\hyperlink{group__pbuf_gaee1baa59bb2f85ba575b5a8619ac1ebf}{pbuf\+\_\+layer}} layer)
\item 
u8\+\_\+t \mbox{\hyperlink{group__pbuf_ga6d803d9945bffb7ad97743f2fa503da6}{pbuf\+\_\+get\+\_\+at}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, u16\+\_\+t offset)
\item 
int \mbox{\hyperlink{group__pbuf_ga839f342803b0cf89049744124c5a98ad}{pbuf\+\_\+try\+\_\+get\+\_\+at}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, u16\+\_\+t offset)
\item 
void \mbox{\hyperlink{group__pbuf_gaf76863707dc02993eae116574b1ea03f}{pbuf\+\_\+put\+\_\+at}} (struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, u16\+\_\+t offset, u8\+\_\+t data)
\item 
u16\+\_\+t \mbox{\hyperlink{group__pbuf_ga2170ccbbb13238380dbb203ee1b85974}{pbuf\+\_\+memcmp}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, u16\+\_\+t offset, const void $\ast$s2, u16\+\_\+t n)
\item 
u16\+\_\+t \mbox{\hyperlink{group__pbuf_ga18c164a6e4a24d89ea9eb7571a886448}{pbuf\+\_\+memfind}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, const void $\ast$\mbox{\hyperlink{structmem}{mem}}, u16\+\_\+t mem\+\_\+len, u16\+\_\+t start\+\_\+offset)
\item 
u16\+\_\+t \mbox{\hyperlink{pbuf_8c_a9ba3f7b705309ceadb147692fd5a1c7d}{pbuf\+\_\+strstr}} (const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$p, const char $\ast$substr)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Packet buffer management 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{pbuf_8c_a5df7ac5ae59012fe9aeddba375a72190}\label{pbuf_8c_a5df7ac5ae59012fe9aeddba375a72190}} 
\index{pbuf.c@{pbuf.c}!pbuf\_clen@{pbuf\_clen}}
\index{pbuf\_clen@{pbuf\_clen}!pbuf.c@{pbuf.c}}
\doxysubsubsection{\texorpdfstring{pbuf\_clen()}{pbuf\_clen()}}
{\footnotesize\ttfamily u16\+\_\+t pbuf\+\_\+clen (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$}]{p }\end{DoxyParamCaption})}

Count number of pbufs in a chain


\begin{DoxyParams}{Parameters}
{\em p} & first pbuf of chain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of pbufs in a chain 
\end{DoxyReturn}


Definition at line 800 of file pbuf.\+c.

\mbox{\Hypertarget{pbuf_8c_abf3d29c4f43986b4cb5eb314d5b9729d}\label{pbuf_8c_abf3d29c4f43986b4cb5eb314d5b9729d}} 
\index{pbuf.c@{pbuf.c}!pbuf\_dechain@{pbuf\_dechain}}
\index{pbuf\_dechain@{pbuf\_dechain}!pbuf.c@{pbuf.c}}
\doxysubsubsection{\texorpdfstring{pbuf\_dechain()}{pbuf\_dechain()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structpbuf}{pbuf}}$\ast$ pbuf\+\_\+dechain (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$}]{p }\end{DoxyParamCaption})}

Dechains the first pbuf from its succeeding pbufs in the chain.

Makes p-\/$>$tot\+\_\+len field equal to p-\/$>$len. 
\begin{DoxyParams}{Parameters}
{\em p} & pbuf to dechain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
remainder of the pbuf chain, or N\+U\+LL if it was de-\/allocated. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
May not be called on a packet queue. 
\end{DoxyNote}


Definition at line 899 of file pbuf.\+c.

\mbox{\Hypertarget{pbuf_8c_a0f81deff4a0e6e8e0ff161a7b9871449}\label{pbuf_8c_a0f81deff4a0e6e8e0ff161a7b9871449}} 
\index{pbuf.c@{pbuf.c}!pbuf\_header@{pbuf\_header}}
\index{pbuf\_header@{pbuf\_header}!pbuf.c@{pbuf.c}}
\doxysubsubsection{\texorpdfstring{pbuf\_header()}{pbuf\_header()}}
{\footnotesize\ttfamily u8\+\_\+t pbuf\+\_\+header (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$}]{p,  }\item[{s16\+\_\+t}]{header\+\_\+size\+\_\+increment }\end{DoxyParamCaption})}

Adjusts the payload pointer to hide or reveal headers in the payload.

Adjusts the -\/$>$payload pointer so that space for a header (dis)appears in the pbuf payload.

The -\/$>$payload, -\/$>$tot\+\_\+len and -\/$>$len fields are adjusted.


\begin{DoxyParams}{Parameters}
{\em p} & pbuf to change the header size. \\
\hline
{\em header\+\_\+size\+\_\+increment} & Number of bytes to increment header size which increases the size of the pbuf. New space is on the front. (Using a negative value decreases the header size.) If hdr\+\_\+size\+\_\+inc is 0, this function does nothing and returns successful.\\
\hline
\end{DoxyParams}
P\+B\+U\+F\+\_\+\+R\+OM and P\+B\+U\+F\+\_\+\+R\+EF type buffers cannot have their sizes increased, so the call will fail. A check is made that the increase in header size does not move the payload pointer in front of the start of the buffer. \begin{DoxyReturn}{Returns}
non-\/zero on failure, zero on success. 
\end{DoxyReturn}


Definition at line 665 of file pbuf.\+c.

\mbox{\Hypertarget{pbuf_8c_ad0e64d6fbc423593461063da97da9ce6}\label{pbuf_8c_ad0e64d6fbc423593461063da97da9ce6}} 
\index{pbuf.c@{pbuf.c}!pbuf\_header\_force@{pbuf\_header\_force}}
\index{pbuf\_header\_force@{pbuf\_header\_force}!pbuf.c@{pbuf.c}}
\doxysubsubsection{\texorpdfstring{pbuf\_header\_force()}{pbuf\_header\_force()}}
{\footnotesize\ttfamily u8\+\_\+t pbuf\+\_\+header\+\_\+force (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$}]{p,  }\item[{s16\+\_\+t}]{header\+\_\+size\+\_\+increment }\end{DoxyParamCaption})}

Same as pbuf\+\_\+header but does not check if \textquotesingle{}header\+\_\+size $>$ 0\textquotesingle{} is allowed. This is used internally only, to allow P\+B\+U\+F\+\_\+\+R\+EF for RX. 

Definition at line 675 of file pbuf.\+c.

\mbox{\Hypertarget{pbuf_8c_a9ba3f7b705309ceadb147692fd5a1c7d}\label{pbuf_8c_a9ba3f7b705309ceadb147692fd5a1c7d}} 
\index{pbuf.c@{pbuf.c}!pbuf\_strstr@{pbuf\_strstr}}
\index{pbuf\_strstr@{pbuf\_strstr}!pbuf.c@{pbuf.c}}
\doxysubsubsection{\texorpdfstring{pbuf\_strstr()}{pbuf\_strstr()}}
{\footnotesize\ttfamily u16\+\_\+t pbuf\+\_\+strstr (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structpbuf}{pbuf}} $\ast$}]{p,  }\item[{const char $\ast$}]{substr }\end{DoxyParamCaption})}

Find occurrence of substr with length substr\+\_\+len in pbuf p, start at offset start\+\_\+offset W\+A\+R\+N\+I\+NG\+: in contrast to strstr(), this one does not stop at the first \textbackslash{}0 in the pbuf/source string!


\begin{DoxyParams}{Parameters}
{\em p} & pbuf to search, maximum length is 0x\+F\+F\+FE since 0x\+F\+F\+FF is used as return value \textquotesingle{}not found\textquotesingle{} \\
\hline
{\em substr} & string to search for in p, maximum length is 0x\+F\+F\+FE \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0x\+F\+F\+FF if substr was not found in p or the index where it was found 
\end{DoxyReturn}


Definition at line 1431 of file pbuf.\+c.

